<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="1189px" preserveAspectRatio="none" style="width:2919px;height:1189px;" version="1.1" viewBox="0 0 2919 1189" width="2919px" zoomAndPan="magnify"><defs><filter height="300%" id="f1kmzmjy1phxp" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><!--cluster beam_client--><rect fill="#FFFFFF" filter="url(#f1kmzmjy1phxp)" height="170" style="stroke: #000000; stroke-width: 1.5;" width="229" x="2644" y="88"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="87" x="2715" y="103.5352">Beam Client</text><!--cluster Beam Client SDK    --><rect fill="#FFFFFF" filter="url(#f1kmzmjy1phxp)" height="87" style="stroke: #000000; stroke-width: 1.5;" width="157" x="2684" y="139"/><polygon fill="#FFFFFF" points="2824,144,2824,158,2836,158,2836,150,2830,144,2824,144" style="stroke: #000000; stroke-width: 1.5;"/><line style="stroke: #000000; stroke-width: 1.5;" x1="2830" x2="2830" y1="144" y2="150"/><line style="stroke: #000000; stroke-width: 1.5;" x1="2836" x2="2830" y1="150" y2="150"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="121" x="2692" y="154.5352">Beam Client SDK</text><!--cluster flink_client--><rect fill="#FFFFFF" filter="url(#f1kmzmjy1phxp)" height="602" style="stroke: #000000; stroke-width: 1.5;" width="615" x="1997" y="144.5"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="118" x="2245.5" y="160.0352">Flink Client JVM</text><!--cluster runner_jar--><rect fill="#FFFFFF" filter="url(#f1kmzmjy1phxp)" height="170" style="stroke: #000000; stroke-width: 1.5;" width="551" x="2029" y="323"/><polygon fill="#FFFFFF" points="2563,328,2563,342,2575,342,2575,334,2569,328,2563,328" style="stroke: #000000; stroke-width: 1.5;"/><line style="stroke: #000000; stroke-width: 1.5;" x1="2569" x2="2569" y1="328" y2="334"/><line style="stroke: #000000; stroke-width: 1.5;" x1="2575" x2="2569" y1="334" y2="334"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="117" x="2246" y="338.5352">Flink Runner Jar</text><!--cluster job_server--><rect fill="#FFFFFF" filter="url(#f1kmzmjy1phxp)" height="87" style="stroke: #000000; stroke-width: 1.5;" width="479" x="2069" y="374"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="87" x="2265" y="389.5352">gRPC Server</text><!--cluster Flink JobManager JVM--><rect fill="#FFFFFF" filter="url(#f1kmzmjy1phxp)" height="154" style="stroke: #000000; stroke-width: 1.5;" width="272" x="2636" y="614"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="160" x="2692" y="629.5352">Flink JobManager JVM</text><!--cluster Flink Deployment--><rect fill="#FFFFFF" filter="url(#f1kmzmjy1phxp)" height="87" style="stroke: #000000; stroke-width: 1.5;" width="224" x="2660" y="657"/><polygon fill="#FFFFFF" points="2867,662,2867,676,2879,676,2879,668,2873,662,2867,662" style="stroke: #000000; stroke-width: 1.5;"/><line style="stroke: #000000; stroke-width: 1.5;" x1="2873" x2="2873" y1="662" y2="668"/><line style="stroke: #000000; stroke-width: 1.5;" x1="2879" x2="2873" y1="668" y2="668"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="128" x="2708" y="672.5352">Flink Deployment</text><!--cluster Flink Worker Node--><polygon fill="#FFFFFF" filter="url(#f1kmzmjy1phxp)" points="22,560,32,550,1973,550,1973,1167,1963,1177,22,1177,22,560" style="stroke: #000000; stroke-width: 1.5;"/><line style="stroke: #000000; stroke-width: 1.5;" x1="1963" x2="1972" y1="560" y2="551"/><line style="stroke: #000000; stroke-width: 1.5;" x1="22" x2="1963" y1="560" y2="560"/><line style="stroke: #000000; stroke-width: 1.5;" x1="1963" x2="1963" y1="560" y2="1177"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="134" x="926.5" y="576.5352">Flink Worker Node</text><!--cluster flink_task--><rect fill="#FFFFFF" filter="url(#f1kmzmjy1phxp)" height="320" style="stroke: #000000; stroke-width: 1.5;" width="1903" x="46" y="833"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="171" x="912" y="848.5352">Flink TaskManager JVM</text><!--cluster Flink Runner Jar--><rect fill="#FFFFFF" filter="url(#f1kmzmjy1phxp)" height="253" style="stroke: #000000; stroke-width: 1.5;" width="1855" x="70" y="876"/><polygon fill="#FFFFFF" points="1908,881,1908,895,1920,895,1920,887,1914,881,1908,881" style="stroke: #000000; stroke-width: 1.5;"/><line style="stroke: #000000; stroke-width: 1.5;" x1="1914" x2="1914" y1="881" y2="887"/><line style="stroke: #000000; stroke-width: 1.5;" x1="1920" x2="1914" y1="887" y2="887"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="117" x="939" y="891.5352">Flink Runner Jar</text><!--cluster harness_manager--><rect fill="#FFFFFF" filter="url(#f1kmzmjy1phxp)" height="170" style="stroke: #000000; stroke-width: 1.5;" width="1613" x="102" y="927"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="124" x="846.5" y="942.5352">Harness Manager</text><!--cluster gRPC Server--><rect fill="#FFFFFF" filter="url(#f1kmzmjy1phxp)" height="87" style="stroke: #000000; stroke-width: 1.5;" width="1541" x="142" y="978"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="87" x="869" y="993.5352">gRPC Server</text><!--cluster docker--><rect fill="#FFFFFF" filter="url(#f1kmzmjy1phxp)" height="170" style="stroke: #000000; stroke-width: 1.5;" width="318" x="623" y="606"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="50" x="757" y="621.5352">Docker</text><!--cluster SDK Harness (Environment)--><rect fill="#FFFFFF" filter="url(#f1kmzmjy1phxp)" height="87" style="stroke: #000000; stroke-width: 1.5;" width="246" x="663" y="657"/><polygon fill="#FFFFFF" points="892,662,892,676,904,676,904,668,898,662,892,662" style="stroke: #000000; stroke-width: 1.5;"/><line style="stroke: #000000; stroke-width: 1.5;" x1="898" x2="898" y1="662" y2="668"/><line style="stroke: #000000; stroke-width: 1.5;" x1="904" x2="898" y1="668" y2="668"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="198" x="687" y="672.5352">SDK Harness (Environment)</text><!--entity beam_client_code--><rect fill="#FEFECE" filter="url(#f1kmzmjy1phxp)" height="36.4883" style="stroke: #000000; stroke-width: 1.5;" width="100" x="2700" y="174"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="80" x="2710" y="197.5352">Client Code</text><path d="M2013,179.5 L2013,204.8105 L2409,204.8105 L2409,189.5 L2399,179.5 L2013,179.5 " fill="#FBFB77" filter="url(#f1kmzmjy1phxp)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M2399,179.5 L2399,189.5 L2409,189.5 L2399,179.5 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="375" x="2019" y="197.0684">A new Flink ExecutionEnvironment is spawned for each job.</text><path d="M2013.5,689.5 L2013.5,730.1211 L2346.5,730.1211 L2346.5,699.5 L2336.5,689.5 L2013.5,689.5 " fill="#FBFB77" filter="url(#f1kmzmjy1phxp)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M2336.5,689.5 L2336.5,699.5 L2346.5,699.5 L2336.5,689.5 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="312" x="2019.5" y="707.0684">The runner jar is submitted to Flink out-of-band.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="143" x="2019.5" y="722.3789">This starts the Job API.</text><!--entity job_service--><rect fill="#FEFECE" filter="url(#f1kmzmjy1phxp)" height="36.4883" style="stroke: #000000; stroke-width: 1.5;" width="152" x="2085" y="409"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="132" x="2095" y="432.5352">Job API (JobService)</text><!--entity artifact_staging--><rect fill="#FEFECE" filter="url(#f1kmzmjy1phxp)" height="36.4883" style="stroke: #000000; stroke-width: 1.5;" width="260" x="2272" y="409"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="240" x="2282" y="432.5352">Artifact API (ArtifactStagingService)</text><!--entity flink_job_manager--><rect fill="#FEFECE" filter="url(#f1kmzmjy1phxp)" height="36.4883" style="stroke: #000000; stroke-width: 1.5;" width="191" x="2676.5" y="692"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="171" x="2686.5" y="715.5352">Flink JobManager Service</text><!--entity operator--><rect fill="#FEFECE" filter="url(#f1kmzmjy1phxp)" height="36.4883" style="stroke: #000000; stroke-width: 1.5;" width="169" x="1739.5" y="1013"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="149" x="1749.5" y="1036.5352">Fused Stage Operator</text><!--entity artifact_retrieval--><rect fill="#FEFECE" filter="url(#f1kmzmjy1phxp)" height="36.4883" style="stroke: #000000; stroke-width: 1.5;" width="267" x="652.5" y="1013"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="247" x="662.5" y="1036.5352">Artifact API (ArtifactRetrievalService)</text><!--entity provision_service--><rect fill="#FEFECE" filter="url(#f1kmzmjy1phxp)" height="36.4883" style="stroke: #000000; stroke-width: 1.5;" width="234" x="955" y="1013"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="214" x="965" y="1036.5352">Provision API (ProvisionService)</text><!--entity control_plane--><rect fill="#FEFECE" filter="url(#f1kmzmjy1phxp)" height="36.4883" style="stroke: #000000; stroke-width: 1.5;" width="233" x="158.5" y="1013"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="213" x="168.5" y="1036.5352">Control Plane (BeamFnControl)</text><!--entity data_plane--><rect fill="#FEFECE" filter="url(#f1kmzmjy1phxp)" height="36.4883" style="stroke: #000000; stroke-width: 1.5;" width="191" x="426.5" y="1013"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="171" x="436.5" y="1036.5352">Data Plane (BeamFnData)</text><!--entity state_api--><rect fill="#FEFECE" filter="url(#f1kmzmjy1phxp)" height="36.4883" style="stroke: #000000; stroke-width: 1.5;" width="182" x="1224" y="1013"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="162" x="1234" y="1036.5352">State API (BeamFnState)</text><!--entity logging_api--><rect fill="#FEFECE" filter="url(#f1kmzmjy1phxp)" height="36.4883" style="stroke: #000000; stroke-width: 1.5;" width="226" x="1441" y="1013"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="206" x="1451" y="1036.5352">Logging API (BeamFnLogging)</text><!--entity fn_execution--><rect fill="#FEFECE" filter="url(#f1kmzmjy1phxp)" height="36.4883" style="stroke: #000000; stroke-width: 1.5;" width="214" x="679" y="692"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="194" x="689" y="715.5352">Boot Code and Fn Execution</text><path d="M2464.5,8 L2464.5,33.3105 L2839.5,33.3105 L2839.5,18 L2829.5,8 L2464.5,8 " fill="#FBFB77" filter="url(#f1kmzmjy1phxp)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M2829.5,8 L2829.5,18 L2839.5,18 L2829.5,8 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="354" x="2470.5" y="25.5684">The client might be code in any Beam SDK (not just Java)</text><!--link GMN8 to beam_client--><path d="M2652,33.15 C2652,42.575 2652,56.9206 2652,73.1942 C2652,77.2626 2652,81.4515 2652,85.7141 C2652,86.247 2652,86.781 2652,87.316 " fill="none" id="GMN8-beam_client" style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 7.0,7.0;"/><!--link GMN18 to runner_jar--><path d="M2189.11,204.579 C2157.68,222.35 2100.12,259.354 2069,307 C2067.1575,309.8212 2065.4206,312.7457 2063.7832,315.7501 C2062.9646,317.2522 2062.1708,318.7744 2061.4011,320.3136 C2061.0163,321.0832 2060.6375,321.8571 2060.2647,322.6349 " fill="none" id="GMN18-runner_jar" style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 7.0,7.0;"/><!--link runner_jar to GMN21--><path d="M2061.9756,493.3893 C2062.0962,493.6692 2062.2169,493.9489 2062.3378,494.2285 C2062.5797,494.7876 2062.8222,495.346 2063.0654,495.9034 C2065.0108,500.3628 2066.9975,504.7621 2069,509 C2101.15,577.039 2146.53,653.938 2167.93,689.298 " fill="none" id="runner_jar-GMN21" style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 7.0,7.0;"/><!--link beam_client_code to job_service--><path d="M2743.94,210.057 C2736.11,229.27 2720.52,259.679 2696,274 C2674.74,286.42 2275.72,295.39 2254,307 C2213.56,328.62 2184.97,376.236 2170.91,404.24 " fill="none" id="beam_client_code-job_service" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="2168.62,408.895,2176.1857,402.5894,2170.8297,404.4098,2169.0094,399.0538,2168.62,408.895" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="24" x="2627" y="295.5684">Run</text><!--link beam_client_code to artifact_staging--><path d="M2741.93,210.029 C2732.81,227.814 2716.53,255.629 2696,274 C2624.22,338.232 2520.38,383.519 2457.25,407.13 " fill="none" id="beam_client_code-artifact_staging" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="2452.4,408.931,2462.2298,409.5435,2457.0865,407.1884,2459.4416,402.0451,2452.4,408.931" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="71" x="2683" y="295.5684">Put Artifact</text><!--link harness_manager to docker--><path d="M103.6336,926.3277 C103.8747,923.5502 104.1573,920.7602 104.485,917.964 C105.7957,906.7791 107.8275,895.4933 110.8119,884.4926 C116.7806,862.4913 126.5595,841.6308 142,825 C179.663,784.434 300.3045,756.0608 412.3251,737.7664 C468.3354,728.6192 522.1905,721.9917 562.4405,717.6197 C582.5655,715.4337 599.2892,713.8116 611.1803,712.7203 C614.1531,712.4475 616.8239,712.2079 619.1702,712.0009 C620.3434,711.8974 621.4355,711.8021 622.4437,711.7149 " fill="none" id="harness_manager-docker" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="622.4437,711.7149,613.1324,708.5055,617.4623,712.1458,613.822,716.4757,622.4437,711.7149" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="123" x="176" y="813.5684">Create Environment</text><!--link job_service to flink_job_manager--><path d="M2175.05,445.322 C2191.68,464.48 2221.29,494.546 2254,509 C2341.99,547.888 2373.15,525.754 2469,534 C2500.71,536.728 2583.09,528.693 2612,542 C2681.05,573.779 2735.47,649.877 2759.14,687.372 " fill="none" id="job_service-flink_job_manager" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="2761.87,691.747,2760.4973,681.9943,2759.2223,687.5056,2753.711,686.2306,2761.87,691.747" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="102" x="2470" y="530.5684">Execute Pipeline</text><!--link artifact_staging to flink_job_manager--><path d="M2441.72,445.048 C2485.65,464.898 2557.43,500.337 2612,542 C2670.88,586.955 2728,653.853 2755.31,687.716 " fill="none" id="artifact_staging-flink_job_manager" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="2758.49,691.678,2755.9742,682.1559,2755.3596,687.7792,2749.7362,687.1646,2758.49,691.678" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="127" x="2598" y="530.5684">Register Cached File</text><!--link flink_job_manager to operator--><path d="M2742.06,728.157 C2710.46,745.791 2658.82,773.246 2612,792 C2357.81,893.813 2042.7,976.544 1900.25,1011.724 " fill="none" id="flink_job_manager-operator" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="1895.26,1012.955,1904.9569,1014.6783,1900.1139,1011.7551,1903.0371,1006.9121,1895.26,1012.955" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="99" x="2593" y="813.5684">Create Operator</text><!--link operator to harness_manager--><path d="M1818.61,1012.979 C1803.6,966.659 1756.3,844.557 1665.5,808.5 C1626.62,793.061 198.38,793.061 159.5,808.5 C113.8938,826.61 100.855,879.3788 99.5341,928.9816 C99.2038,941.3823 99.606,953.5852 100.4147,964.9992 C100.819,970.7062 101.325,976.2159 101.892,981.4546 C101.9274,981.782 101.9631,982.1084 101.999,982.4337 " fill="none" id="operator-harness_manager" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="101.999,982.4337,104.9876,973.0492,101.4505,977.4638,97.0358,973.9268,101.999,982.4337" style="stroke: #A80036; stroke-width: 1.0;"/><!--link fn_execution to artifact_retrieval--><path d="M786,728.151 C786,781.917 786,947.178 786,1007.587 " fill="none" id="fn_execution-artifact_retrieval" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="786,1012.764,790,1003.764,786,1007.764,782,1003.764,786,1012.764" style="stroke: #A80036; stroke-width: 1.0;"/><!--link fn_execution to provision_service--><path d="M814.168,728.063 C846.336,748.446 899.366,784.865 937,825 C992.599,884.296 1040.29,969.04 1060.99,1008.39 " fill="none" id="fn_execution-provision_service" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="1063.38,1012.959,1062.7518,1003.1302,1061.062,1008.5288,1055.6634,1006.839,1063.38,1012.959" style="stroke: #A80036; stroke-width: 1.0;"/><!--link fn_execution to control_plane--><path d="M764.647,731.456 C743.6,750.362 709.644,777.631 675,792 C658.481,798.852 533.765,814.943 516,817 C492.314,819.743 429.534,812.879 409,825 C337.428,867.247 297.031,964.494 281.928,1008.121 " fill="none" id="fn_execution-control_plane" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="280.294,1012.92,286.9806,1005.6889,281.9051,1008.1867,279.4073,1003.1111,280.294,1012.92" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="768.424,728.028,759.071,731.1137,764.7212,731.3879,764.4469,737.0382,768.424,728.028" style="stroke: #A80036; stroke-width: 1.0;"/><!--link fn_execution to data_plane--><path d="M757.81,731.3 C716.878,760.924 644.78,813.712 635,825 C584.446,883.348 546.696,967.987 530.585,1007.767 " fill="none" id="fn_execution-data_plane" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="528.547,1012.847,535.6096,1005.9826,530.4081,1008.2063,528.1845,1003.0048,528.547,1012.847" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="762.156,728.157,752.5192,730.1899,758.1045,731.0871,757.2073,736.6723,762.156,728.157" style="stroke: #A80036; stroke-width: 1.0;"/><!--link fn_execution to state_api--><path d="M893.187,716.688 C985.002,726.605 1116.24,753.362 1206,825 C1267,873.686 1298.08,966.001 1309.61,1008.093 " fill="none" id="fn_execution-state_api" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="1310.91,1012.971,1312.4408,1003.2418,1309.6141,1008.1418,1304.7141,1005.3152,1310.91,1012.971" style="stroke: #A80036; stroke-width: 1.0;"/><!--link fn_execution to logging_api--><path d="M893.28,719.789 C1051.52,734.469 1337.97,768.112 1423,825 C1491.14,870.588 1531.26,964.903 1546.68,1007.842 " fill="none" id="fn_execution-logging_api" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="1548.44,1012.817,1549.2132,1002.9985,1546.7743,1008.1026,1541.6702,1005.6637,1548.44,1012.817" style="stroke: #A80036; stroke-width: 1.0;"/><!--
@startuml

!pragma horizontalLineBetweenDifferentPackageAllowed

note top of beam_client: The client might be code in any Beam SDK (not just Java)
rectangle "Beam Client" as beam_client {
    artifact "Beam Client SDK    " {
        rectangle "Client Code" as beam_client_code
    }
}

rectangle "Flink Client JVM" as flink_client {
    artifact "Flink Runner Jar" as runner_jar {
        rectangle "gRPC Server" as job_server {
            rectangle "Job API (JobService)" as job_service
            rectangle "Artifact API (ArtifactStagingService)" as artifact_staging
        }
    }
    note top of runner_jar: A new Flink ExecutionEnvironment is spawned for each job.
    note bottom of runner_jar: The runner jar is submitted to Flink out-of-band.\nThis starts the Job API.
}

rectangle "Flink JobManager JVM" {
    artifact "Flink Deployment" {
        rectangle "Flink JobManager Service" as flink_job_manager
    }
}

node "Flink Worker Node" {
    rectangle "Flink TaskManager JVM" as flink_task {
        artifact "Flink Runner Jar" {
            rectangle "Harness Manager" as harness_manager {
                rectangle "gRPC Server" {
                    rectangle "Artifact API (ArtifactRetrievalService)" as artifact_retrieval
                    rectangle "Provision API (ProvisionService)" as provision_service
                    rectangle "Control Plane (BeamFnControl)" as control_plane
                    rectangle "Data Plane (BeamFnData)" as data_plane
                    rectangle "State API (BeamFnState)" as state_api
                    rectangle "Logging API (BeamFnLogging)" as logging_api
                }
            }
            rectangle "Fused Stage Operator" as operator
        }
    }
    rectangle "Docker" as docker {
        artifact "SDK Harness (Environment)" {
            rectangle "Boot Code and Fn Execution" as fn_execution
        }
    }
}

beam_client_code - -> job_service: Run
beam_client_code - -> artifact_staging: Put Artifact

harness_manager - -> docker: Create Environment

job_service - -> flink_job_manager: Execute Pipeline
artifact_staging - -> flink_job_manager: Register Cached File

flink_job_manager - -> operator: Create Operator

operator -> harness_manager

fn_execution - -> artifact_retrieval
fn_execution - -> provision_service
fn_execution <-> control_plane
fn_execution <-> data_plane
fn_execution - -> state_api
fn_execution - -> logging_api

@enduml

PlantUML version 1.2018.01(Sun Jan 28 10:08:22 PST 2018)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Java Version: 1.8.0_151-b12
Operating System: Mac OS X
OS Version: 10.13.3
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>